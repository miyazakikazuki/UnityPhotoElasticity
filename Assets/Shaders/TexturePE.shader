Shader "Custom/TexturePE" {
	Properties{
		_Stress("Texture",2D) = "white"{}
		_Intensity("Intensity", Range(0, 5)) = 0.5
		_Samples("Samples", float) = 40
	}
	SubShader{
		Pass{
			CGPROGRAM
			#pragma vertex vert
			#pragma fragment frag
			#pragma target 3.0

			#include "UnityCG.cginc"

			sampler2D _Stress;
			float4 _Stress_ST;
			fixed _Intensity;
			fixed _Samples;
			
			static const float4 sp2rgb[441] = { float4(0.0000491902094930,0.0033016206397905,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000772072770700, 0.0),float4(0.0098514408835784,-0.0000989302114300,0.0001886567608500, 0.0),float4(-0.0001263033799300,0.0002242281970300,0.0139803565361586, 0.0),float4(0.0002647778286000,0.0165789038552884,-0.0002023370356400, 0.0),float4(0.0195903063028568,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000601478102700,0.0001312670662700,0.0082390131129395, 0.0),float4(0.0001577903448000,0.0098514408835784,-0.0000989302114300, 0.0),float4(0.0117518658754856,-0.0001263033799300,0.0002242281970300, 0.0),float4(-0.0001603900978700,0.0002647778286000,0.0165789038552884, 0.0),float4(0.0003104519996200,0.0195903063028568,-0.0002532880805600, 0.0),float4(0.0230574578732082,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000601478102700,0.0001312670662700,0.0082390131129395, 0.0),float4(0.0001577903448000,0.0098514408835784,-0.0000989302114300, 0.0),float4(0.0117518658754856,-0.0001263033799300,0.0002242281970300, 0.0),float4(-0.0001603900978700,0.0002647778286000,0.0165789038552884, 0.0),float4(0.0003104519996200,0.0195903063028568,-0.0002532880805600, 0.0),float4(0.0230574578732082,-0.0003142861612000,0.0004177593186500, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000772072770700, 0.0),float4(0.0098514408835784,-0.0000989302114300,0.0001886567608500, 0.0),float4(-0.0001263033799300,0.0002242281970300,0.0139803565361586, 0.0),float4(0.0002647778286000,0.0165789038552884,-0.0002023370356400, 0.0),float4(0.0195903063028568,-0.0002532880805600,0.0003613196199800, 0.0),float4(-0.0003142861612000,0.0004177593186500,0.0270247706550970, 0.0),float4(0.0004803866726800,0.0315358731701182,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0002023370356400,0.0003104519996200,0.0195903063028568, 0.0),float4(0.0003613196199800,0.0230574578732082,-0.0003142861612000, 0.0),float4(0.0270247706550970,-0.0003863161515600,0.0004803866726800, 0.0),float4(-0.0004701737323800,0.0005500216138400,0.0366311206069136, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0001603900978700, 0.0),float4(0.0165789038552884,-0.0002023370356400,0.0003104519996200, 0.0),float4(-0.0002532880805600,0.0003613196199800,0.0230574578732082, 0.0),float4(0.0004177593186500,0.0270247706550970,-0.0003863161515600, 0.0),float4(0.0315358731701182,-0.0004701737323800,0.0005500216138400, 0.0),float4(-0.0005664883460200,0.0006277782757100,0.0423457348340674, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0001603900978700, 0.0),float4(0.0165789038552884,-0.0002023370356400,0.0003104519996200, 0.0),float4(-0.0002532880805600,0.0003613196199800,0.0230574578732082, 0.0),float4(0.0004177593186500,0.0270247706550970,-0.0003863161515600, 0.0),float4(0.0315358731701182,-0.0004701737323800,0.0005500216138400, 0.0),float4(-0.0005664883460200,0.0006277782757100,0.0423457348340674, 0.0),float4(0.0007149174138200,0.0487064273778488,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0002023370356400,0.0003104519996200,0.0195903063028568, 0.0),float4(0.0003613196199800,0.0230574578732082,-0.0003142861612000, 0.0),float4(0.0270247706550970,-0.0003863161515600,0.0004803866726800, 0.0),float4(-0.0004701737323800,0.0005500216138400,0.0366311206069136, 0.0),float4(0.0006277782757100,0.0423457348340674,-0.0006760231799400, 0.0),float4(0.0487064273778488,-0.0008013662695000,0.0008120500876500, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000772072770700, 0.0),float4(0.0098514408835784,-0.0000989302114300,0.0001886567608500, 0.0),float4(-0.0001263033799300,0.0002242281970300,0.0139803565361586, 0.0),float4(0.0002647778286000,0.0165789038552884,-0.0002023370356400, 0.0),float4(0.0195903063028568,-0.0002532880805600,0.0003613196199800, 0.0),float4(-0.0003142861612000,0.0004177593186500,0.0270247706550970, 0.0),float4(0.0004803866726800,0.0315358731701182,-0.0004701737323800, 0.0),float4(0.0366311206069136,-0.0005664883460200,0.0006277782757100, 0.0),float4(-0.0006760231799400,0.0007149174138200,0.0487064273778488, 0.0),float4(0.0008120500876500,0.0557252046089810,-0.0009464092803200, 0.0),float4(0.0633971842664944,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000601478102700,0.0001312670662700,0.0082390131129395, 0.0),float4(0.0001577903448000,0.0098514408835784,-0.0000989302114300, 0.0),float4(0.0117518658754856,-0.0001263033799300,0.0002242281970300, 0.0),float4(-0.0001603900978700,0.0002647778286000,0.0165789038552884, 0.0),float4(0.0003104519996200,0.0195903063028568,-0.0002532880805600, 0.0),float4(0.0230574578732082,-0.0003142861612000,0.0004177593186500, 0.0),float4(-0.0003863161515600,0.0004803866726800,0.0315358731701182, 0.0),float4(0.0005500216138400,0.0366311206069136,-0.0005664883460200, 0.0),float4(0.0423457348340674,-0.0006760231799400,0.0007149174138200, 0.0),float4(-0.0008013662695000,0.0008120500876500,0.0557252046089810, 0.0),float4(0.0009193973781600,0.0633971842664944,-0.0011161342925800, 0.0),float4(0.0716976629291016,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000601478102700,0.0001312670662700,0.0082390131129395, 0.0),float4(0.0001577903448000,0.0098514408835784,-0.0000989302114300, 0.0),float4(0.0117518658754856,-0.0001263033799300,0.0002242281970300, 0.0),float4(-0.0001603900978700,0.0002647778286000,0.0165789038552884, 0.0),float4(0.0003104519996200,0.0195903063028568,-0.0002532880805600, 0.0),float4(0.0230574578732082,-0.0003142861612000,0.0004177593186500, 0.0),float4(-0.0003863161515600,0.0004803866726800,0.0315358731701182, 0.0),float4(0.0005500216138400,0.0366311206069136,-0.0005664883460200, 0.0),float4(0.0423457348340674,-0.0006760231799400,0.0007149174138200, 0.0),float4(-0.0008013662695000,0.0008120500876500,0.0557252046089810, 0.0),float4(0.0009193973781600,0.0633971842664944,-0.0011161342925800, 0.0),float4(0.0716976629291016,-0.0013167057850000,0.0011640331143000, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000772072770700, 0.0),float4(0.0098514408835784,-0.0000989302114300,0.0001886567608500, 0.0),float4(-0.0001263033799300,0.0002242281970300,0.0139803565361586, 0.0),float4(0.0002647778286000,0.0165789038552884,-0.0002023370356400, 0.0),float4(0.0195903063028568,-0.0002532880805600,0.0003613196199800, 0.0),float4(-0.0003142861612000,0.0004177593186500,0.0270247706550970, 0.0),float4(0.0004803866726800,0.0315358731701182,-0.0004701737323800, 0.0),float4(0.0366311206069136,-0.0005664883460200,0.0006277782757100, 0.0),float4(-0.0006760231799400,0.0007149174138200,0.0487064273778488, 0.0),float4(0.0008120500876500,0.0557252046089810,-0.0009464092803200, 0.0),float4(0.0633971842664944,-0.0011161342925800,0.0010368794890900, 0.0),float4(-0.0013167057850000,0.0011640331143000,0.0805787740847990, 0.0),float4(0.0013001829544000,0.0899763864224480,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0002023370356400,0.0003104519996200,0.0195903063028568, 0.0),float4(0.0003613196199800,0.0230574578732082,-0.0003142861612000, 0.0),float4(0.0270247706550970,-0.0003863161515600,0.0004803866726800, 0.0),float4(-0.0004701737323800,0.0005500216138400,0.0366311206069136, 0.0),float4(0.0006277782757100,0.0423457348340674,-0.0006760231799400, 0.0),float4(0.0487064273778488,-0.0008013662695000,0.0008120500876500, 0.0),float4(-0.0009464092803200,0.0009193973781600,0.0633971842664944, 0.0),float4(0.0010368794890900,0.0716976629291016,-0.0013167057850000, 0.0),float4(0.0805787740847990,-0.0015542487212000,0.0013001829544000, 0.0),float4(-0.0018302413401000,0.0014453325286000,0.0998458641546220, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0001603900978700, 0.0),float4(0.0165789038552884,-0.0002023370356400,0.0003104519996200, 0.0),float4(-0.0002532880805600,0.0003613196199800,0.0230574578732082, 0.0),float4(0.0004177593186500,0.0270247706550970,-0.0003863161515600, 0.0),float4(0.0315358731701182,-0.0004701737323800,0.0005500216138400, 0.0),float4(-0.0005664883460200,0.0006277782757100,0.0423457348340674, 0.0),float4(0.0007149174138200,0.0487064273778488,-0.0008013662695000, 0.0),float4(0.0557252046089810,-0.0009464092803200,0.0009193973781600, 0.0),float4(-0.0011161342925800,0.0010368794890900,0.0716976629291016, 0.0),float4(0.0011640331143000,0.0805787740847990,-0.0015542487212000, 0.0),float4(0.0899763864224480,-0.0018302413401000,0.0014453325286000, 0.0),float4(-0.0021436778922000,0.0015997875978000,0.1101474127329840, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0001603900978700, 0.0),float4(0.0165789038552884,-0.0002023370356400,0.0003104519996200, 0.0),float4(-0.0002532880805600,0.0003613196199800,0.0230574578732082, 0.0),float4(0.0004177593186500,0.0270247706550970,-0.0003863161515600, 0.0),float4(0.0315358731701182,-0.0004701737323800,0.0005500216138400, 0.0),float4(-0.0005664883460200,0.0006277782757100,0.0423457348340674, 0.0),float4(0.0007149174138200,0.0487064273778488,-0.0008013662695000, 0.0),float4(0.0557252046089810,-0.0009464092803200,0.0009193973781600, 0.0),float4(-0.0011161342925800,0.0010368794890900,0.0716976629291016, 0.0),float4(0.0011640331143000,0.0805787740847990,-0.0015542487212000, 0.0),float4(0.0899763864224480,-0.0018302413401000,0.0014453325286000, 0.0),float4(-0.0021436778922000,0.0015997875978000,0.1101474127329840, 0.0),float4(0.0017639870368000,0.1208398955577180,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0002023370356400,0.0003104519996200,0.0195903063028568, 0.0),float4(0.0003613196199800,0.0230574578732082,-0.0003142861612000, 0.0),float4(0.0270247706550970,-0.0003863161515600,0.0004803866726800, 0.0),float4(-0.0004701737323800,0.0005500216138400,0.0366311206069136, 0.0),float4(0.0006277782757100,0.0423457348340674,-0.0006760231799400, 0.0),float4(0.0487064273778488,-0.0008013662695000,0.0008120500876500, 0.0),float4(-0.0009464092803200,0.0009193973781600,0.0633971842664944, 0.0),float4(0.0010368794890900,0.0716976629291016,-0.0013167057850000, 0.0),float4(0.0805787740847990,-0.0015542487212000,0.0013001829544000, 0.0),float4(-0.0018302413401000,0.0014453325286000,0.0998458641546220, 0.0),float4(0.0015997875978000,0.1101474127329840,-0.0024919307824000, 0.0),float4(0.1208398955577180,-0.0028706043272000,0.0019384937927000, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000772072770700, 0.0),float4(0.0098514408835784,-0.0000989302114300,0.0001886567608500, 0.0),float4(-0.0001263033799300,0.0002242281970300,0.0139803565361586, 0.0),float4(0.0002647778286000,0.0165789038552884,-0.0002023370356400, 0.0),float4(0.0195903063028568,-0.0002532880805600,0.0003613196199800, 0.0),float4(-0.0003142861612000,0.0004177593186500,0.0270247706550970, 0.0),float4(0.0004803866726800,0.0315358731701182,-0.0004701737323800, 0.0),float4(0.0366311206069136,-0.0005664883460200,0.0006277782757100, 0.0),float4(-0.0006760231799400,0.0007149174138200,0.0487064273778488, 0.0),float4(0.0008120500876500,0.0557252046089810,-0.0009464092803200, 0.0),float4(0.0633971842664944,-0.0011161342925800,0.0010368794890900, 0.0),float4(-0.0013167057850000,0.0011640331143000,0.0805787740847990, 0.0),float4(0.0013001829544000,0.0899763864224480,-0.0018302413401000, 0.0),float4(0.0998458641546220,-0.0021436778922000,0.0015997875978000, 0.0),float4(-0.0024919307824000,0.0017639870368000,0.1208398955577180, 0.0),float4(0.0019384937927000,0.1318824965125140,-0.0032751598369000, 0.0),float4(0.1432173808661280,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000601478102700,0.0001312670662700,0.0082390131129395, 0.0),float4(0.0001577903448000,0.0098514408835784,-0.0000989302114300, 0.0),float4(0.0117518658754856,-0.0001263033799300,0.0002242281970300, 0.0),float4(-0.0001603900978700,0.0002647778286000,0.0165789038552884, 0.0),float4(0.0003104519996200,0.0195903063028568,-0.0002532880805600, 0.0),float4(0.0230574578732082,-0.0003142861612000,0.0004177593186500, 0.0),float4(-0.0003863161515600,0.0004803866726800,0.0315358731701182, 0.0),float4(0.0005500216138400,0.0366311206069136,-0.0005664883460200, 0.0),float4(0.0423457348340674,-0.0006760231799400,0.0007149174138200, 0.0),float4(-0.0008013662695000,0.0008120500876500,0.0557252046089810, 0.0),float4(0.0009193973781600,0.0633971842664944,-0.0011161342925800, 0.0),float4(0.0716976629291016,-0.0013167057850000,0.0011640331143000, 0.0),float4(-0.0015542487212000,0.0013001829544000,0.0899763864224480, 0.0),float4(0.0014453325286000,0.0998458641546220,-0.0021436778922000, 0.0),float4(0.1101474127329840,-0.0024919307824000,0.0017639870368000, 0.0),float4(-0.0028706043272000,0.0019384937927000,0.1318824965125140, 0.0),float4(0.0021239587504000,0.1432173808661280,-0.0037050957523000, 0.0),float4(0.1547015415397760,-0.0000184766313360,0.0000491902094930, 0.0),float4(-0.0000229484212080,0.0000602435319590,0.0039697781635461, 0.0),float4(0.0000735841517630,0.0047717609136525,-0.0000366729935660, 0.0),float4(0.0057317384412499,-0.0000468868105440,0.0001086776597770, 0.0),float4(-0.0000601478102700,0.0001312670662700,0.0082390131129395, 0.0),float4(0.0001577903448000,0.0098514408835784,-0.0000989302114300, 0.0),float4(0.0117518658754856,-0.0001263033799300,0.0002242281970300, 0.0),float4(-0.0001603900978700,0.0002647778286000,0.0165789038552884, 0.0),float4(0.0003104519996200,0.0195903063028568,-0.0002532880805600, 0.0),float4(0.0230574578732082,-0.0003142861612000,0.0004177593186500, 0.0),float4(-0.0003863161515600,0.0004803866726800,0.0315358731701182, 0.0),float4(0.0005500216138400,0.0366311206069136,-0.0005664883460200, 0.0),float4(0.0423457348340674,-0.0006760231799400,0.0007149174138200, 0.0),float4(-0.0008013662695000,0.0008120500876500,0.0557252046089810, 0.0),float4(0.0009193973781600,0.0633971842664944,-0.0011161342925800, 0.0),float4(0.0716976629291016,-0.0013167057850000,0.0011640331143000, 0.0),float4(-0.0015542487212000,0.0013001829544000,0.0899763864224480, 0.0),float4(0.0014453325286000,0.0998458641546220,-0.0021436778922000, 0.0),float4(0.1101474127329840,-0.0024919307824000,0.0017639870368000, 0.0),float4(-0.0028706043272000,0.0019384937927000,0.1318824965125140, 0.0),float4(0.0021239587504000,0.1432173808661280,-0.0037050957523000, 0.0),float4(0.1547015415397760,-0.0041611430857000,0.0025279069094000, 0.0),float4(-0.0000184766313360,0.0000491902094930,0.0033016206397905, 0.0),float4(0.0000602435319590,0.0039697781635461,-0.0000288700019460, 0.0),float4(0.0047717609136525,-0.0000366729935660,0.0000895924549880, 0.0),float4(-0.0000468868105440,0.0001086776597770,0.0068771941733619, 0.0),float4(0.0001312670662700,0.0082390131129395,-0.0000772072770700, 0.0),float4(0.0098514408835784,-0.0000989302114300,0.0001886567608500, 0.0),float4(-0.0001263033799300,0.0002242281970300,0.0139803565361586, 0.0),float4(0.0002647778286000,0.0165789038552884,-0.0002023370356400, 0.0),float4(0.0195903063028568,-0.0002532880805600,0.0003613196199800, 0.0),float4(-0.0003142861612000,0.0004177593186500,0.0270247706550970, 0.0),float4(0.0004803866726800,0.0315358731701182,-0.0004701737323800, 0.0),float4(0.0366311206069136,-0.0005664883460200,0.0006277782757100, 0.0),float4(-0.0006760231799400,0.0007149174138200,0.0487064273778488, 0.0),float4(0.0008120500876500,0.0557252046089810,-0.0009464092803200, 0.0),float4(0.0633971842664944,-0.0011161342925800,0.0010368794890900, 0.0),float4(-0.0013167057850000,0.0011640331143000,0.0805787740847990, 0.0),float4(0.0013001829544000,0.0899763864224480,-0.0018302413401000, 0.0),float4(0.0998458641546220,-0.0021436778922000,0.0015997875978000, 0.0),float4(-0.0024919307824000,0.0017639870368000,0.1208398955577180, 0.0),float4(0.0019384937927000,0.1318824965125140,-0.0032751598369000, 0.0),float4(0.1432173808661280,-0.0037050957523000,0.0023204797593000, 0.0),float4(-0.0041611430857000,0.0025279069094000,0.1661438345551240, 0.0),float4(0.0027459470778000,0.1773229609764760,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0002023370356400,0.0003104519996200,0.0195903063028568, 0.0),float4(0.0003613196199800,0.0230574578732082,-0.0003142861612000, 0.0),float4(0.0270247706550970,-0.0003863161515600,0.0004803866726800, 0.0),float4(-0.0004701737323800,0.0005500216138400,0.0366311206069136, 0.0),float4(0.0006277782757100,0.0423457348340674,-0.0006760231799400, 0.0),float4(0.0487064273778488,-0.0008013662695000,0.0008120500876500, 0.0),float4(-0.0009464092803200,0.0009193973781600,0.0633971842664944, 0.0),float4(0.0010368794890900,0.0716976629291016,-0.0013167057850000, 0.0),float4(0.0805787740847990,-0.0015542487212000,0.0013001829544000, 0.0),float4(-0.0018302413401000,0.0014453325286000,0.0998458641546220, 0.0),float4(0.0015997875978000,0.1101474127329840,-0.0024919307824000, 0.0),float4(0.1208398955577180,-0.0028706043272000,0.0019384937927000, 0.0),float4(-0.0032751598369000,0.0021239587504000,0.1432173808661280, 0.0),float4(0.0023204797593000,0.1547015415397760,-0.0041611430857000, 0.0),float4(0.1661438345551240,-0.0046441913723000,0.0027459470778000, 0.0),float4(-0.0051550647274000,0.0029740926337000,0.1879910070288480, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0001603900978700, 0.0),float4(0.0165789038552884,-0.0002023370356400,0.0003104519996200, 0.0),float4(-0.0002532880805600,0.0003613196199800,0.0230574578732082, 0.0),float4(0.0004177593186500,0.0270247706550970,-0.0003863161515600, 0.0),float4(0.0315358731701182,-0.0004701737323800,0.0005500216138400, 0.0),float4(-0.0005664883460200,0.0006277782757100,0.0423457348340674, 0.0),float4(0.0007149174138200,0.0487064273778488,-0.0008013662695000, 0.0),float4(0.0557252046089810,-0.0009464092803200,0.0009193973781600, 0.0),float4(-0.0011161342925800,0.0010368794890900,0.0716976629291016, 0.0),float4(0.0011640331143000,0.0805787740847990,-0.0015542487212000, 0.0),float4(0.0899763864224480,-0.0018302413401000,0.0014453325286000, 0.0),float4(-0.0021436778922000,0.0015997875978000,0.1101474127329840, 0.0),float4(0.0017639870368000,0.1208398955577180,-0.0028706043272000, 0.0),float4(0.1318824965125140,-0.0032751598369000,0.0021239587504000, 0.0),float4(-0.0037050957523000,0.0023204797593000,0.1547015415397760, 0.0),float4(0.0025279069094000,0.1661438345551240,-0.0046441913723000, 0.0),float4(0.1773229609764760,-0.0051550647274000,0.0029740926337000, 0.0),float4(-0.0056941958710000,0.0032118608945000,0.1979432643919000, 0.0),float4(0.0000491902094930,0.0033016206397905,-0.0000229484212080, 0.0),float4(0.0039697781635461,-0.0000288700019460,0.0000735841517630, 0.0),float4(-0.0000366729935660,0.0000895924549880,0.0057317384412499, 0.0),float4(0.0001086776597770,0.0068771941733619,-0.0000601478102700, 0.0),float4(0.0082390131129395,-0.0000772072770700,0.0001577903448000, 0.0),float4(-0.0000989302114300,0.0001886567608500,0.0117518658754856, 0.0),float4(0.0002242281970300,0.0139803565361586,-0.0001603900978700, 0.0),float4(0.0165789038552884,-0.0002023370356400,0.0003104519996200, 0.0),float4(-0.0002532880805600,0.0003613196199800,0.0230574578732082, 0.0),float4(0.0004177593186500,0.0270247706550970,-0.0003863161515600, 0.0),float4(0.0315358731701182,-0.0004701737323800,0.0005500216138400, 0.0),float4(-0.0005664883460200,0.0006277782757100,0.0423457348340674, 0.0),float4(0.0007149174138200,0.0487064273778488,-0.0008013662695000, 0.0),float4(0.0557252046089810,-0.0009464092803200,0.0009193973781600, 0.0),float4(-0.0011161342925800,0.0010368794890900,0.0716976629291016, 0.0),float4(0.0011640331143000,0.0805787740847990,-0.0015542487212000, 0.0),float4(0.0899763864224480,-0.0018302413401000,0.0014453325286000, 0.0),float4(-0.0021436778922000,0.0015997875978000,0.1101474127329840, 0.0),float4(0.0017639870368000,0.1208398955577180,-0.0028706043272000, 0.0),float4(0.1318824965125140,-0.0032751598369000,0.0021239587504000, 0.0),float4(-0.0037050957523000,0.0023204797593000,0.1547015415397760, 0.0),float4(0.0025279069094000,0.1661438345551240,-0.0046441913723000, 0.0),float4(0.1773229609764760,-0.0051550647274000,0.0029740926337000, 0.0),float4(-0.0056941958710000,0.0032118608945000,0.1979432643919000, 0.0),float4(0.0034596418003000,0.2072393805119020,-0.0000184766313360, 0.0),float4(0.0033016206397905,-0.0000229484212080,0.0000602435319590, 0.0),float4(-0.0000288700019460,0.0000735841517630,0.0047717609136525, 0.0),float4(0.0000895924549880,0.0057317384412499,-0.0000468868105440, 0.0),float4(0.0068771941733619,-0.0000601478102700,0.0001312670662700, 0.0),float4(-0.0000772072770700,0.0001577903448000,0.0098514408835784, 0.0),float4(0.0001886567608500,0.0117518658754856,-0.0001263033799300, 0.0),float4(0.0139803565361586,-0.0001603900978700,0.0002647778286000, 0.0),float4(-0.0002023370356400,0.0003104519996200,0.0195903063028568, 0.0),float4(0.0003613196199800,0.0230574578732082,-0.0003142861612000, 0.0),float4(0.0270247706550970,-0.0003863161515600,0.0004803866726800, 0.0),float4(-0.0004701737323800,0.0005500216138400,0.0366311206069136, 0.0),float4(0.0006277782757100,0.0423457348340674,-0.0006760231799400, 0.0),float4(0.0487064273778488,-0.0008013662695000,0.0008120500876500, 0.0),float4(-0.0009464092803200,0.0009193973781600,0.0633971842664944, 0.0),float4(0.0010368794890900,0.0716976629291016,-0.0013167057850000, 0.0),float4(0.0805787740847990,-0.0015542487212000,0.0013001829544000, 0.0),float4(-0.0018302413401000,0.0014453325286000,0.0998458641546220, 0.0),float4(0.0015997875978000,0.1101474127329840,-0.0024919307824000, 0.0),float4(0.1208398955577180,-0.0028706043272000,0.0019384937927000, 0.0),float4(-0.0032751598369000,0.0021239587504000,0.1432173808661280, 0.0) };

			struct v2f {
				float4  pos : POSITION;
				float2  uv : TEXCOORD0;
			};

			

			v2f vert(appdata_base v) {
				v2f o;
				o.pos = UnityObjectToClipPos(v.vertex);
				o.uv = TRANSFORM_TEX(v.texcoord, _Stress);
				return o;
			}

			fixed4 frag(v2f i) : SV_Target{
				float4 stress = tex2D(_Stress, i.uv);
				float b = stress.x + stress.y;
				float c = stress.x * stress.y - stress.z * stress.z;

				float eigenvalue  = - b + sqrt(b * b - 4.0 * c);
				float _eigenvalue = - b - sqrt(b * b - 4.0 * c);

				float2 eigenvector  = float2(stress.z, stress.x - eigenvalue);
				float2 _eigenvector = float2(stress.z, stress.x - _eigenvalue);

				float sin2theta = 1.0 - pow(dot(normalize(eigenvector), normalize(_eigenvector)), 2);

				float difference, intensity;
				float4 rgb = float4(0.0, 0.0, 0.0, 1.0);

				for (int index = 0; index<_Samples; index++) {
					difference = 200 * 3.14 * 72.0 * 0.05 * (eigenvalue - _eigenvalue) / (390.0 + 440.0 / _Samples * index);
					intensity = _Intensity * pow(sin(difference), 2) * sin2theta;
					rgb = rgb + 200.0 * intensity * sp2rgb[index * 440.0 / _Samples];
				}
				return fixed4(rgb/_Samples);
				//return fixed4(5 * sp2rgb[280].x, 0.0,0.0,0.0);
			}
			ENDCG
		}
	}
}
